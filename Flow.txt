End-to-End Container Deployment on AWS: ECR + ECS
Updated


ğŸ” Internal Architecture Flow
ğŸ”¹ What is ECR?
ğŸ”¹ What is ECS?
1ï¸âƒ£ EC2 Launch Type
2ï¸âƒ£ Fargate Launch Type
Node Base Image
ğŸ”¹ Why Do We Need to Create an ECS Cluster?
Step 2: Create Task Definition
Issue
ğŸ” What Happens Internally?
Step 1 â†’ Create EC2 (for build environment)

Step 2 â†’ Install Docker & AWS CLI

Step 3 â†’ Create ECR Repository

step 4 â†’ clone Repo on ec2

Step 4 â†’ Build Docker Image

Step 5 â†’ Authenticate & Push Image to ECR

Step 6 â†’ Create ECS Cluster (Fargate)

Step 7 â†’ Create Task Definition

Step 8 â†’ Create Service

Step 9 â†’ Configure Security Group

Step 10 â†’ Access Application via Public IP:8000

ğŸ” Internal Architecture Flow
Developer â†’ Docker Build â†’ ECR (Image Storage)
        â†“
ECS Task Definition â†’ ECS Cluster â†’ Fargate
        â†“
Container Running
        â†“
Security Group Allows Port 8000
        â†“
Application Accessible via Public IP

Create EC2 and ECR on aws install all prerequisites

ECR = Elastic Container Registry

ğŸ”¹ What is ECR?
Amazon Elastic Container Registry (ECR) is a fully managed Docker image registry.

It stores:

Docker images

Image versions (tags)

Secure private repositories

Think of it like Docker Hub inside AWS.

ECS = Elasic Container Service

ğŸ”¹ What is ECS?
Amazon Elastic Container Service (ECS) is a container orchestration service.

It helps you:

Run containers

Manage scaling

Handle networking

Maintain availability

Instead of manually running:

docker run

ECS runs and manages containers for you.

1ï¸âƒ£ EC2 Launch Type
You manage EC2 instances.
Containers run on those EC2 servers.

More control, more responsibility.

2ï¸âƒ£ Fargate Launch Type
Serverless container engine.
No need to manage EC2.

AWS manages infrastructure.

below prerequisites we have to install before push on ecr

Make sure that you have the latest version of the AWS CLI and Docker installed. For more information, see Getting started with Amazon ECR .

Use the following steps to authenticate and push an image to your repository. For additional registry authentication methods, including the Amazon ECR credential helper, see Registry authentication .

Retrieve an authentication token and authenticate your Docker client to your registry. Use the AWS CLI:

aws ecr get-login-password --region eu-west-1 | docker login --username AWS --password-stdin 130255498314.dkr.ecr.eu-west-1.amazonaws.com

Note: if you receive an error using the AWS CLI, make sure that you have the latest version of the AWS CLI and Docker installed.

Build your Docker image using the following command. For information on building a Docker file from scratch, see the instructions here . You can skip this step if your image has already been built:

docker build -t aws-services .

After the build is completed, tag your image so you can push the image to this repository:

docker tag aws-services:latest 130255498314.dkr.ecr.eu-west-1.amazonaws.com/aws-services:latest

Run the following command to push this image to your newly created AWS repository:

docker push 130255498314.dkr.ecr.eu-west-1.amazonaws.com/aws-services:latest



after installing aws CLI you can connect to aws ECR by IAM user
after using above command u can connect to ECR
now you can build image and push to ECR

docker file

Node Base Image
FROM node:12.2.0-alpine

#Working Directry WORKDIR /node

#Copy the Code COPY . .

#Install the dependecies RUN npm install RUN npm run test EXPOSE 8000

#Run the code CMD ["node","app.js"]

after push



after pushing image on ECR now we have to run image so create cluster on ECS

ğŸ”¹ Why Do We Need to Create an ECS Cluster?
A cluster is a logical group where your containers run.

Think of it like this:

Docker image â†’ runs inside container
Container â†’ runs inside task
Task â†’ runs inside cluster

So without a cluster, ECS does not know where to run your container.



Step 2: Create Task Definition
Task Definition = Blueprint of container.

It defines:

Which image to use

which port to use for image

CPU & Memory

Port mappings

Environment variables

IAM role





and you can choose your cluster and it will run



Task is running so so you can access your app on 8000 port

Issue


sometime port is not enabled so in task â†’ in networking â†’ ENI ID â†’ Security Groups â†’ edit inboud rules and add 8000 port
application will run now



ğŸ” What Happens Internally?
ECS pulls image from ECR

ECS creates container

Container runs inside AWS managed infrastructure

If container crashes â†’ ECS restarts automatically
